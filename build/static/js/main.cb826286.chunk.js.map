{"version":3,"sources":["assets/acc_karma/story_bg sync /^/Story_.*/.png$","assets/acc_karma/story_bg/Story_green.png","assets/acc_karma/story_bg/Story_red.png","assets/acc_karma/story_bg/Story_yellow.png","assets/vk_acc_price/icons/group_subscribe.png","assets/acc_karma/icons sync /^/.*/.png$","assets/acc_karma/icons/0.png","assets/acc_karma/icons/1.png","assets/acc_karma/icons/2.png","assets/acc_karma/app_bg sync /^/.*/.png$","assets/acc_karma/app_bg/red.png","assets/acc_karma/app_bg/yellow.png","assets/acc_karma/vk_acc_price.png","components/ClickerBattle/Button.js","js/utils.js","assets/acc_karma/icons/return_to_result.svg","assets/acc_karma/icons/go_to_app.svg","apps/AccKarma.js","index.js","assets/acc_karma/app_bg/green.png","assets/acc_karma/icons/progress.png"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","Button","this","props","before","after","children","style","onClick","className","afterStyle","paddingLeft","color","React","cloneElement","paddingRight","PureComponent","convertTextToLines","text","font","max_width","ctx","createCanvas","require","getContext","result","i","j","width","lines","length","measureText","substr","indexOf","push","Math","max","get","url","params","a","query","value","encodeURIComponent","join","url_","Promise","res","rej","fetch","method","then","json","answer","catch","err","error","toString","defaultFonts","loadFonts","fonts","span","document","createElement","fontFamily","innerText","body","appendChild","setTimeout","remove","getRandomInt","min","floor","random","getUrlParams","window","location","search","JSON","parse","decodeURI","substring","replace","openUrl","element","href","target","click","_extends","assign","arguments","source","key","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","d","fill","_ref","svgRef","title","height","viewBox","ref","ForwardRef","forwardRef","proxyUrl","AccKarma","state","popout","history","activePanel","currentMessageIndex","messages","karma","componentDidMount","bind","back","setState","pushState","pop","bridge","send","status","snackbar","go","panel","addEventListener","preventDefault","subscribe","detail","type","data","undefined","console","log","schemeAttribute","createAttribute","attributes","setNamedItem","supports","status_bar_style","action_bar_color","app_id","vk_app_id","response","app","scope","parseInt","split","access_token","getStoryCanvas","canvas","background_type","blob","toDataURL","attachment","token","toBlob","uploadStoryPhotoToWall","loadImage","result_text","background","textSize","textLines","drawImage","textAlign","fillStyle","fillText","v","uploadWallUrl","upload_url","bodyFormData","FormData","append","res_","server","photo","hash","caption","wallPhoto","message","copyright","attachments","owner_id","album_id","uploadAlbumUrl","photos_list","activeModal","panels","description","button","getToken","onClose","group_id","group_id_message","subShow","ad_format","interval","setInterval","clearInterval","savedData","fields","counters","stringify","uploadStoryPhotoToAlbum","icon","loadingComponent","shareStory","modal","size","shadow","src","header","actions","group_id_join","isWebView","onSwipeBack","index","alt","marginTop","percent","round","animationPlayState","Component","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.cb826286.chunk.js","sourcesContent":["var map = {\n\t\"./Story_green.png\": 289,\n\t\"./Story_red.png\": 290,\n\t\"./Story_yellow.png\": 291\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 288;","module.exports = __webpack_public_path__ + \"static/media/Story_green.22e92e35.png\";","module.exports = __webpack_public_path__ + \"static/media/Story_red.a4a904ab.png\";","module.exports = __webpack_public_path__ + \"static/media/Story_yellow.48c23ca0.png\";","module.exports = __webpack_public_path__ + \"static/media/group_subscribe.9ba1c89b.png\";","var map = {\n\t\"./0.png\": 294,\n\t\"./1.png\": 295,\n\t\"./2.png\": 296,\n\t\"./progress.png\": 96\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 293;","module.exports = __webpack_public_path__ + \"static/media/0.ac9740c6.png\";","module.exports = __webpack_public_path__ + \"static/media/1.8bfb2c27.png\";","module.exports = __webpack_public_path__ + \"static/media/2.35968bce.png\";","var map = {\n\t\"./green.png\": 49,\n\t\"./red.png\": 298,\n\t\"./yellow.png\": 299\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 297;","module.exports = __webpack_public_path__ + \"static/media/red.0762d7f4.png\";","module.exports = __webpack_public_path__ + \"static/media/yellow.a33fb1eb.png\";","module.exports = __webpack_public_path__ + \"static/media/vk_acc_price.b7b5e20c.png\";","import React, {PureComponent} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport '../../css/ClickerBattle/Button.css';\r\n\r\nexport class Button extends PureComponent {\r\n\r\n    render() {\r\n        const\r\n            {before, after, children, style, onClick, className} = this.props,\r\n            afterStyle = {\r\n                paddingLeft: 6,\r\n                color: 'rgba(87, 64, 57, 0.6)'\r\n            }\r\n        ;\r\n\r\n        return (\r\n            <div className={'CustomButton' + (className ? ` ${className}` : '')} style={style} onClick={onClick}>\r\n                {before && React.cloneElement(before, {style: {...before.props.style, paddingRight: 10}})}\r\n                <span>{children}</span>\r\n                {after && (typeof after === 'object' ? React.cloneElement(after, {\r\n                    style: afterStyle\r\n                }) : <span style={afterStyle}>{after}</span>)}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nButton.propTypes = {\r\n    before: PropTypes.any,\r\n    after: PropTypes.any,\r\n    style: PropTypes.object,\r\n    onClick: PropTypes.func,\r\n    className: PropTypes.string\r\n};\r\n\r\nexport default Button;","import {default as bridge} from '@vkontakte/vk-bridge';\r\n\r\nexport function convertTextToLines(text, font, max_width) {\r\n    const\r\n        {createCanvas} = require('canvas'),\r\n        canvas = createCanvas(1080, 1920),\r\n        ctx = canvas.getContext('2d')\r\n    ;\r\n    ctx.font = font;\r\n    let width = 0, lines = [], result, i, j;\r\n\r\n    while (text.length) {\r\n        for (i = text.length; ctx.measureText(text.substr(0, i)).width > max_width; i--) ;\r\n        result = text.substr(0, i);\r\n\r\n        if (i !== text.length)\r\n\r\n            for (j = 0; result.indexOf(' ', j) !== -1; j = result.indexOf(' ', j) + 1) ;\r\n        lines.push(result.substr(0, j || result.length));\r\n\r\n        width = Math.max(width, ctx.measureText(lines[lines.length - 1]).width);\r\n        text = text.substr(lines[lines.length - 1].length, text.length);\r\n    }\r\n\r\n    return lines;\r\n}\r\n\r\nexport async function get(url, params) {\r\n    const\r\n        query = params ? '?' + Object.keys(params).map((value) =>\r\n            encodeURIComponent(value) + '=' + encodeURIComponent(params[value])\r\n        ).join('&') : '',\r\n        url_ = `${url}${query}`;\r\n    return await new Promise((res, rej) => {\r\n        fetch(url_, {method: 'GET'})\r\n            .then(res =>\r\n                res.json()\r\n            )\r\n            .then(answer =>\r\n                res(answer)\r\n            ).catch(err =>\r\n            res({error: {code: -1, text: err.toString()}})\r\n        );\r\n    });\r\n}\r\n\r\nexport const defaultFonts = [\r\n    'SF Pro Text',\r\n    'SF Pro Text Heavy',\r\n    'SF Pro Text Semibold',\r\n    'SF Pro Display',\r\n    'SF Pro Display Bold',\r\n    'SF Pro Display Semibold',\r\n    'SF Pro Display Medium',\r\n    'SF Pro Rounded',\r\n    'SF Pro Rounded Semibold',\r\n    'SF Pro Rounded Bold',\r\n    'SF UI Display',\r\n    'SF UI Text',\r\n    'TT Commons',\r\n    'TT Commons Bold',\r\n    'TT Commons Demibold',\r\n    'Manrope ExtraBold'\r\n];\r\n\r\nexport function loadFonts(fonts = defaultFonts) {\r\n    for (const font of fonts) {\r\n        const span = document.createElement('span');\r\n        span.style.fontFamily = font;\r\n        span.innerText = '.';\r\n        document.body.appendChild(span);\r\n        setTimeout(() => span.remove(), 1);\r\n    }\r\n}\r\n\r\nexport function animateValue(obj, start, end, duration) {\r\n    if (start === end || end - start === 1) {\r\n        obj.innerHTML = end;\r\n    } else {\r\n        let startTimestamp = null;\r\n        const step = (timestamp) => {\r\n            if (!startTimestamp) startTimestamp = timestamp;\r\n            const progress = Math.min((timestamp - startTimestamp) / duration, 1);\r\n            obj.innerHTML = Math.floor(progress * (end - start) + start);\r\n            if (progress < 1) {\r\n                window.requestAnimationFrame(step);\r\n            }\r\n        };\r\n        window.requestAnimationFrame(step);\r\n    }\r\n}\r\n\r\nexport function cps(array) {\r\n    if (array.length !== 0) {\r\n        let\r\n            first_date = array[0],\r\n            cur_pos = 0,\r\n            clicks_per_second = []\r\n        ;\r\n        array = array.map(value => value - first_date);\r\n\r\n        for (const click of array) {\r\n            cur_pos = click < 1000 ? 0 : parseInt((click + '').substring(0, (click + '').length - 3));\r\n            clicks_per_second[cur_pos] = clicks_per_second[cur_pos] > 0 ? clicks_per_second[cur_pos] + 1 : 1;\r\n        }\r\n\r\n        clicks_per_second = clicks_per_second.filter(value => value > 0);\r\n\r\n        const\r\n            max_cps = Math.max(...clicks_per_second),\r\n            min_cps = Math.min(...clicks_per_second),\r\n            mid_cps = Math.ceil((max_cps + min_cps) / 2)\r\n        ;\r\n        return {max_cps, min_cps, mid_cps};\r\n    } else {\r\n        return {max_cps: 0, min_cps: 0, mid_cps: 0};\r\n    }\r\n}\r\n\r\nfunction componentToHex(c) {\r\n    const hex = c.toString(16);\r\n    return hex.length == 1 ? '0' + hex : hex;\r\n}\r\n\r\nexport function rgbToHex(r, g, b) {\r\n    return '#' + componentToHex(r) + componentToHex(g) + componentToHex(b);\r\n}\r\n\r\nexport function sleep(ms) {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n\r\nexport function decOfNum(number, titles, needNumber = true) {\r\n    if (number !== undefined) {\r\n        let decCache = [],\r\n            decCases = [2, 0, 1, 1, 1, 2];\r\n        if (!decCache[number]) decCache[number] = number % 100 > 4 && number % 100 < 20 ? 2 : decCases[Math.min(number % 10, 5)];\r\n        return (needNumber ? number + ' ' : '') + titles[decCache[number]];\r\n    }\r\n}\r\n\r\nexport function numToStr(number) {\r\n    if (number > 0 && number <= 10) {\r\n        const words = [\r\n            'первое', 'второе', 'третье', 'четвертое', 'пятое', 'шестое', 'седьмое', 'восьмое', 'девятое', 'десятое'\r\n        ];\r\n        return words[number - 1];\r\n    } else {\r\n        return number + '';\r\n    }\r\n}\r\n\r\nexport function shortIntegers(int) {\r\n    try {\r\n        return int.toString().replace(/(\\d)(?=(\\d\\d\\d)+([^\\d]|$))/g, '$1 ');\r\n    } catch (e) {\r\n        return 0;\r\n    }\r\n}\r\n\r\nexport function getRandomInt(min, max) {\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\nexport function getRandomInts(min, max, count) {\r\n    const array = [];\r\n    for (let i = 0; i < count; i++) {\r\n        const int = getRandomInt(min, max);\r\n        if (array.indexOf(int) === -1) {\r\n            array.push(int);\r\n        } else {\r\n            if (max >= count)\r\n                i--;\r\n            else\r\n                array.push(int);\r\n        }\r\n    }\r\n    return array;\r\n}\r\n\r\nexport function nodeToString(node) {\r\n    let tmpNode = document.createElement(\"div\");\r\n    tmpNode.appendChild(node.cloneNode(true));\r\n    let str = tmpNode.innerHTML;\r\n    tmpNode = node = null;\r\n    return str;\r\n}\r\n\r\nexport function convertMiliseconds(miliseconds) {\r\n    let hours, minutes, total_hours, total_minutes, total_seconds;\r\n\r\n    total_seconds = parseInt(Math.floor(miliseconds / 1000));\r\n    total_minutes = parseInt(Math.floor(total_seconds / 60));\r\n    total_hours = parseInt(Math.floor(total_minutes / 60));\r\n\r\n    minutes = parseInt(total_minutes % 60);\r\n    hours = parseInt(total_hours % 24);\r\n\r\n    return hours + 'ч. ' + minutes + 'мин.';\r\n}\r\n\r\nexport function convertMsToNormalTime(miliseconds) {\r\n    let hours, minutes, seconds, total_hours, total_minutes, total_seconds;\r\n\r\n    total_seconds = parseInt(Math.floor(miliseconds / 1000));\r\n    total_minutes = parseInt(Math.floor(total_seconds / 60));\r\n    total_hours = parseInt(Math.floor(total_minutes / 60));\r\n\r\n    seconds = parseInt(total_seconds % 60);\r\n    minutes = parseInt(total_minutes % 60);\r\n    hours = parseInt(total_hours % 24);\r\n\r\n    return {hours, minutes, seconds};\r\n}\r\n\r\nconst getImage = (src) =>\r\n    new Promise((res, rej) => {\r\n        const image = new Image();\r\n\r\n        image.onload = () => res(image);\r\n        image.crossOrigin = 'anonymous';\r\n        image.onstalled = (e) => {\r\n            console.log('Failed to fetch data, but trying.', e);\r\n            rej(e);\r\n        };\r\n        image.onerror = (e) => {\r\n            console.log('Failed to fetch data, error.', e);\r\n            rej(e);\r\n        };\r\n        image.src = src;\r\n    });\r\n\r\nexport async function toBlob(object, dataUrl = true) {\r\n    const\r\n        myCanvas = document.createElement('canvas'),\r\n        ctxt = myCanvas.getContext('2d');\r\n\r\n    let base = typeof object === 'string' ? object : window.btoa(object);\r\n    const img = await getImage(typeof object === 'string' ? base : `data:image/svg+xml;base64,${base}`);\r\n    myCanvas.height = img.height;\r\n    myCanvas.width = img.width;\r\n    if (ctxt === null) {\r\n        return \"\";\r\n    }\r\n    ctxt.drawImage(img, 0, 0, img.width, img.height);\r\n    return dataUrl ? myCanvas.toDataURL() : myCanvas;\r\n}\r\n\r\nexport function getUrlParams() {\r\n    return window.location.search.length > 0 && JSON.parse('{\"' + decodeURI(window.location.search.substring(1)).replace(/\"/g, '\\\\\"').replace(/&/g, '\",\"').replace(/=/g, '\":\"') + '\"}');\r\n}\r\n\r\nexport const platforms = {\r\n    desktop_web: /desktop_web/g,\r\n    mobile_android: /mobile_android/g,\r\n    mobile_android_messenger: /mobile_android_messenger/g,\r\n    mobile_ipad: /mobile_ipad/g,\r\n    mobile_iphone: /mobile_iphone/g,\r\n    mobile_iphone_messenger: /mobile_iphone_messenger/g,\r\n    mobile_web: /mobile_web/g,\r\n\r\n    android: /mobile_android|mobile_android_messenger/g,\r\n    ios: /mobile_ipad|mobile_iphone|mobile_iphone_messenger/g\r\n};\r\n\r\nexport function isPlatformIOS() {\r\n    return getUrlParams().vk_platform === 'mobile_iphone';\r\n}\r\n\r\nexport function isPlatformAndroid() {\r\n    return platforms.android.test(getUrlParams().vk_platform);\r\n}\r\n\r\nexport function isPlatformDesktop() {\r\n    return getUrlParams().vk_platform === 'desktop_web';\r\n}\r\n\r\nexport let\r\n    vk_local_users = {},\r\n    name_cases = ['first_name', 'last_name', 'first_name_dat', 'first_name_nom', 'first_name_gen', 'first_name_acc', 'first_name_ins', 'first_name_abl', 'last_name_dat', 'last_name_nom', 'last_name_gen', 'last_name_acc', 'last_name_ins', 'last_name_abl']\r\n;\r\n\r\nexport async function getVKUsers(ids) {\r\n    const\r\n        user_ids = [\r\n            ...new Set(\r\n                ids\r\n                    .filter(value => vk_local_users[value] === undefined)\r\n                    .map(\r\n                        value => typeof value === 'number' ? value : value.replace('@', '')\r\n                            .replace('id', '')\r\n                            .replace('vk.com/', '')\r\n                            .replace('http://', '')\r\n                            .replace('https://', '')\r\n                    )\r\n            )\r\n        ],\r\n        i = Math.floor(user_ids.length / 100)\r\n    ;\r\n\r\n    if (user_ids.length > 0) {\r\n        let users = [];\r\n\r\n        for (let j = 0; j < i + 1; j++) {\r\n            users = users.concat(\r\n                await vkApiRequest('users.get', {\r\n                    user_ids: user_ids.slice(j * 100, j * 100 + 100).join(','),\r\n                    fields: ['screen_name', 'photo_100', 'photo_200', 'photo_max_orig', 'sex', ...name_cases].join(',')\r\n                })\r\n            );\r\n        }\r\n\r\n        for (const user of users) {\r\n            vk_local_users[user.id] = user;\r\n        }\r\n    }\r\n\r\n    return ids.map(value => vk_local_users[value] || vk_local_users[Object.keys(vk_local_users).find(key => vk_local_users[key].screen_name === value)]);\r\n}\r\n\r\nexport async function vkApiRequest(method, params = {}) {\r\n    return (await bridge.send('VKWebAppCallAPIMethod', {\r\n        method,\r\n        params: {\r\n            ...params,\r\n            v: '5.126',\r\n            access_token: params.access_token\r\n        }\r\n    })).response\r\n}\r\n\r\nexport function viewportToPixels(value) {\r\n    const\r\n        parts = value.match(/([0-9\\.]+)(vh|vw)/),\r\n        q = Number(parts[1]),\r\n        side = window[['innerHeight', 'innerWidth'][['vh', 'vw'].indexOf(parts[2])]]\r\n    ;\r\n    return side * (q / 100)\r\n}\r\n\r\nexport function openUrl(url) {\r\n    const element = document.createElement('a');\r\n    element.href = url;\r\n    element.target = '_blank';\r\n    element.click();\r\n    element.remove();\r\n}\r\n\r\nexport function getUrlLocation() {\r\n    return window.location.origin + window.location.pathname.replace('/index.html', '');\r\n}\r\n\r\nexport function getSrcUrl(resource) {\r\n    return getUrlLocation() + resource.substring(1);\r\n}\r\n\r\nexport async function getBase64Image(imageUri) {\r\n    const\r\n        canvas = document.createElement('canvas'),\r\n        ctx = canvas.getContext('2d'),\r\n        img = new Image()\r\n    ;\r\n    img.src = 'https://murmuring-bastion-20764.herokuapp.com/' + imageUri;\r\n    img.crossOrigin = 'Anonymous';\r\n    return await new Promise(resolve =>\r\n        img.onload = function () {\r\n            canvas.width = this.width;\r\n            canvas.height = this.height;\r\n            ctx.drawImage(img, 0, 0, this.width, this.height);\r\n            resolve(canvas.toDataURL('image/png'));\r\n        }\r\n    );\r\n}","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M19.5715 12.3423C19.1371 12.2034 18.6951 12.0891 18.2478 12C18.6951 11.9109 19.1371 11.7966 19.5715 11.6577C20.4762 11.4543 21.3227 10.9786 22.0204 10.2811C23.7702 8.53187 24.0013 5.91657 22.5355 4.45123C22.0025 3.91846 21.2889 3.58914 20.4979 3.50495C20.4137 2.71435 20.0842 2.00084 19.5513 1.46812C18.8311 0.748101 17.8204 0.411497 16.7049 0.519929C15.6176 0.625774 14.5573 1.14532 13.7194 1.98297C13.0217 2.68047 12.5458 3.52665 12.3424 4.4311C12.2034 4.86536 12.0891 5.30712 12 5.75428C11.9109 5.30712 11.7966 4.86536 11.6576 4.4311C11.4542 3.52665 10.9783 2.68047 10.2806 1.98297C9.44267 1.14532 8.38248 0.625774 7.2951 0.519929C6.18003 0.411497 5.16892 0.748053 4.44865 1.46822C3.9158 2.00084 3.58632 2.71401 3.5021 3.50495C2.71124 3.58914 1.99749 3.91846 1.46454 4.45123C-0.00129634 5.91657 0.229781 8.53187 1.97956 10.2811C2.6773 10.9786 3.52377 11.4543 4.42847 11.6577C4.86293 11.7966 5.30489 11.9109 5.75224 12C5.30489 12.0891 4.86293 12.2034 4.42847 12.3423C3.52377 12.5456 2.6773 13.0213 1.97956 13.7188C0.229781 15.4681 -0.00129616 18.0834 1.46468 19.5487C1.99759 20.0815 2.71124 20.4108 3.50225 20.495C3.58646 21.2856 3.91594 21.9991 4.4488 22.5318C5.16906 23.2518 6.17984 23.5886 7.29525 23.48C8.38252 23.3742 9.44257 22.8546 10.2807 22.017C10.9785 21.3195 11.4543 20.4733 11.6577 19.5689C11.7967 19.1346 11.9109 18.6928 12 18.2457C12.0891 18.6928 12.2034 19.1346 12.3424 19.5689C12.5458 20.4733 13.0217 21.3195 13.7194 22.017C14.5573 22.8546 15.6175 23.3742 16.7049 23.48C16.8421 23.4934 16.9775 23.5 17.1112 23.5C18.0643 23.5 18.9197 23.1633 19.5513 22.5318C20.0842 21.9991 20.4137 21.2857 20.4979 20.495C21.2888 20.4108 22.0026 20.0815 22.5355 19.5487C24.0013 18.0834 23.7702 15.4681 22.0204 13.7188C21.3227 13.0213 20.4762 12.5456 19.5715 12.3423Z\",\n  fill: \"white\"\n});\n\nvar SvgReturnToResult = function SvgReturnToResult(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), title ? React.createElement(\"title\", null, title) : null, _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgReturnToResult, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/return_to_result.de57093a.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M15 0C6.74004 0 0 6.74115 0 15C0 23.26 6.74115 30 15 30C23.26 30 30 23.2588 30 15C30 6.74004 23.2588 0 15 0ZM26.6628 8.73328L22.5954 10.5821C21.8286 9.26883 20.7312 8.17143 19.4179 7.40461L21.2667 3.33721C23.5494 4.56867 25.4313 6.45064 26.6628 8.73328ZM22.0312 15C22.0312 18.877 18.877 22.0312 15 22.0312C11.123 22.0312 7.96875 18.877 7.96875 15C7.96875 11.123 11.123 7.96875 15 7.96875C18.877 7.96875 22.0312 11.123 22.0312 15ZM15 1.75781C16.6421 1.75781 18.215 2.0591 19.6673 2.60795L17.8189 6.67453C16.9337 6.374 15.9855 6.21094 15 6.21094C14.0145 6.21094 13.0663 6.374 12.1811 6.67453L10.3327 2.60795C11.785 2.0591 13.3579 1.75781 15 1.75781ZM8.73334 3.33721L10.5821 7.40461C9.26889 8.17143 8.17148 9.26883 7.40467 10.5821L3.33727 8.73328C4.56867 6.45064 6.45064 4.56867 8.73334 3.33721ZM1.75781 15C1.75781 13.3579 2.0591 11.785 2.60795 10.3327L6.67453 12.1812C6.374 13.0663 6.21094 14.0145 6.21094 15C6.21094 15.9855 6.374 16.9337 6.67453 17.8188L2.60795 19.6673C2.0591 18.215 1.75781 16.6421 1.75781 15ZM3.33721 21.2667L7.40461 19.4179C8.17143 20.7311 9.26883 21.8286 10.5821 22.5953L8.73328 26.6627C6.45064 25.4313 4.56867 23.5494 3.33721 21.2667ZM15 28.2422C13.3579 28.2422 11.785 27.9409 10.3327 27.392L12.1811 23.3255C13.0663 23.626 14.0145 23.7891 15 23.7891C15.9855 23.7891 16.9337 23.626 17.8189 23.3255L19.6673 27.392C18.215 27.9409 16.6421 28.2422 15 28.2422ZM21.2667 26.6628L19.4179 22.5954C20.7311 21.8286 21.8286 20.7312 22.5953 19.4179L26.6627 21.2667C25.4313 23.5494 23.5494 25.4313 21.2667 26.6628ZM23.3255 17.8188C23.626 16.9337 23.7891 15.9855 23.7891 15C23.7891 14.0145 23.626 13.0663 23.3255 12.1812L27.392 10.3327C27.9409 11.785 28.2422 13.3579 28.2422 15C28.2422 16.6421 27.9409 18.215 27.392 19.6673L23.3255 17.8188Z\",\n  fill: \"white\"\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M14.0274 16.3824C14.0274 16.0643 14.1252 15.7606 14.3207 15.4714C14.5237 15.1822 14.7418 14.9508 14.9749 14.7773C15.208 14.5965 15.4223 14.3869 15.6178 14.1483C15.8209 13.9097 15.9224 13.6711 15.9224 13.4325C15.9224 13.1794 15.8322 12.9842 15.6517 12.8468C15.4712 12.7095 15.2193 12.6408 14.8959 12.6408C14.2643 12.6408 13.8169 12.9625 13.5537 13.606L12.2227 12.8685C12.4483 12.3335 12.8054 11.9214 13.2942 11.6322C13.7905 11.3357 14.3432 11.1875 14.9523 11.1875C15.6366 11.1875 16.227 11.3791 16.7233 11.7623C17.2271 12.1383 17.479 12.6588 17.479 13.324C17.479 13.6277 17.4113 13.9097 17.276 14.1699C17.1481 14.4302 16.9902 14.6544 16.8022 14.8424C16.6217 15.0231 16.4375 15.1966 16.2495 15.3629C16.069 15.522 15.9111 15.6883 15.7758 15.8618C15.6479 16.0353 15.584 16.2089 15.584 16.3824H14.0274ZM15.4825 18.8009C15.2945 18.9816 15.0689 19.072 14.8057 19.072C14.5425 19.072 14.3169 18.9816 14.1289 18.8009C13.9409 18.6201 13.8469 18.4032 13.8469 18.1502C13.8469 17.8971 13.9409 17.6802 14.1289 17.4994C14.3169 17.3187 14.5425 17.2283 14.8057 17.2283C15.0689 17.2283 15.2945 17.3187 15.4825 17.4994C15.6705 17.6802 15.7645 17.8971 15.7645 18.1502C15.7645 18.4032 15.6705 18.6201 15.4825 18.8009Z\",\n  fill: \"white\"\n});\n\nvar SvgGoToApp = function SvgGoToApp(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 30,\n    height: 30,\n    viewBox: \"0 0 30 30\",\n    fill: \"none\",\n    ref: svgRef\n  }, props), title ? React.createElement(\"title\", null, title) : null, _ref2, _ref3);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgGoToApp, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/go_to_app.7529e2a4.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react';\r\nimport bridge from '@vkontakte/vk-bridge';\r\nimport '../css/AccKarma.css';\r\n\r\nimport {\r\n    Panel,\r\n    View,\r\n    ScreenSpinner, Snackbar, ConfigProvider, ModalRoot, ModalCard, Avatar\r\n} from '@vkontakte/vkui';\r\nimport Button from \"../components/ClickerBattle/Button\";\r\nimport {\r\n    animateValue,\r\n    convertTextToLines,\r\n    decOfNum,\r\n    get,\r\n    getRandomInt,\r\n    getUrlParams,\r\n    loadFonts,\r\n    openUrl,\r\n    shortIntegers\r\n} from \"../js/utils\";\r\nimport {Icon16ErrorCircleFill} from \"@vkontakte/icons\";\r\nimport {ReactComponent as IconResult} from \"../assets/acc_karma/icons/return_to_result.svg\";\r\nimport {ReactComponent as IconPosterApp} from \"../assets/acc_karma/icons/go_to_app.svg\";\r\nimport fetch from 'node-fetch';\r\nimport parser from \"fast-xml-parser\";\r\n\r\nconst\r\n    getAppUrl = 'https://vds2153919.my-ihor.ru:8081/api/apps.get',\r\n    proxyUrl = ['https://murmuring-bastion-20764.herokuapp.com/', 'https://vds2153919.my-ihor.ru:8088/'][getRandomInt(0, 1)],\r\n\r\n    subAppID = 7916609, // Стоимость страницы ВКонтакте\r\n    needSubApp = false, // Нужно ли упоминание второстепенного приложения\r\n\r\n    normalCounters = {\r\n        albums: 3,\r\n        audios: 150,\r\n        followers: 500,\r\n        friends: 500,\r\n        groups: 300,\r\n        photos: 100,\r\n        videos: 3\r\n    }\r\n;\r\n\r\nclass AccKarma extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            popout: null,\r\n            history: ['p0'],\r\n            activePanel: 'p0',\r\n\r\n            currentMessageIndex: 0,\r\n            messages: [\r\n                'Считаем друзей...',\r\n                'Получаем дату регистрации...',\r\n                'Анализируем общую активность странички...',\r\n                'Оцениваем фотки...',\r\n                'Смотрим подписки...',\r\n                'Секретная информация...',\r\n                'Оценка почти готова...'\r\n            ],\r\n\r\n            karma: 0\r\n        };\r\n\r\n        this.componentDidMount = this.componentDidMount.bind(this);\r\n        this.back = () => {\r\n            if (this.state.popout !== null) {\r\n                this.setState({popout: null});\r\n                window.history.pushState({pop: 'popout'}, 'Title');\r\n                return;\r\n            }\r\n            let {history} = this.state;\r\n            if (history.length === 1) {\r\n                bridge.send('VKWebAppClose', {status: 'success'});\r\n            } else if (history.length > 1) {\r\n                history.pop();\r\n                this.setState({activePanel: history[history.length - 1], history, snackbar: null});\r\n            }\r\n        };\r\n        this.go = (panel) => {\r\n            let {history} = this.state;\r\n            if (history[history.length - 1] !== panel) {\r\n                history.push(panel);\r\n                window.history.pushState({activePanel: panel}, 'Title');\r\n                this.setState({activePanel: panel, history, snackbar: null});\r\n            }\r\n        }\r\n    }\r\n\r\n    async componentDidMount() {\r\n        loadFonts(['ProximaNova Bold', 'ProximaNova']);\r\n\r\n        window.addEventListener('popstate', e => {\r\n            e.preventDefault();\r\n            this.back();\r\n        });\r\n\r\n        bridge.subscribe(async ({detail: {type, data}}) => {\r\n            if (type !== undefined) console.log(type, data);\r\n            if (type === 'VKWebAppUpdateConfig') {\r\n                const schemeAttribute = document.createAttribute('scheme');\r\n                schemeAttribute.value = 'bright_light';\r\n                document.body.attributes.setNamedItem(schemeAttribute);\r\n                if (bridge.supports('VKWebAppSetViewSettings')) {\r\n                    bridge.send('VKWebAppSetViewSettings', {\r\n                        status_bar_style: 'light',\r\n                        action_bar_color: '#050602'\r\n                    });\r\n                }\r\n            } else if (type === 'VKWebAppViewRestore') {\r\n                this.setState({popout: null});\r\n            }\r\n        });\r\n\r\n        this.setState({app: (await get(getAppUrl, {app_id: getUrlParams().vk_app_id})).response});\r\n\r\n        bridge.send('VKWebAppInit');\r\n        bridge.send('VKWebAppEnableSwipeBack');\r\n    }\r\n\r\n    async getToken(scope) {\r\n        try {\r\n            const response = await bridge.send('VKWebAppGetAuthToken', {\r\n                app_id: parseInt(getUrlParams().vk_app_id),\r\n                scope\r\n            });\r\n\r\n            if (response.scope.split(', ').length === scope.split(', ').length)\r\n                return response.access_token;\r\n            else\r\n                return false;\r\n        } catch (e) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    async shareStory() {\r\n        try {\r\n            const canvas = await this.getStoryCanvas();\r\n            await bridge.send('VKWebAppShowStoryBox', {\r\n                background_type: 'image',\r\n                blob: canvas.toDataURL('image/png'),\r\n                attachment: {\r\n                    text: 'go_to',\r\n                    type: 'url',\r\n                    url: `https://vk.com/app${getUrlParams().vk_app_id}`\r\n                }\r\n            });\r\n\r\n            if (this.state.token) {\r\n                canvas.toBlob(async function (blob) {\r\n                    this.uploadStoryPhotoToWall(blob);\r\n                }.bind(this));\r\n            }\r\n        } catch (e) {\r\n        }\r\n\r\n        if (needSubApp)\r\n            this.go('sub_app');\r\n        else\r\n            this.setState({activePanel: 'p7', history: ['p7']})\r\n    }\r\n\r\n    async getStoryCanvas() {\r\n        const\r\n            {createCanvas, loadImage} = require('canvas'),\r\n            canvas = createCanvas(1080, 1920),\r\n            ctx = canvas.getContext('2d'),\r\n            {karma, result_text} = this.state,\r\n\r\n            background = await loadImage(require(`../assets/acc_karma/story_bg/Story_${karma <= 333 ? 'red' : (karma <= 667 ? 'yellow' : 'green')}.png`)),\r\n\r\n            textSize = 72,\r\n            textFont = textSize + 'px ProximaNova',\r\n            textLines = convertTextToLines(result_text, textFont, 698)\r\n        ;\r\n\r\n        ctx.drawImage(background, 0, 0);\r\n\r\n        ctx.textAlign = 'center';\r\n\r\n        ctx.fillStyle = '#FFFFFF';\r\n        ctx.font = '190px ProximaNova Bold';\r\n        ctx.fillText(`${karma}/1000`, 539.5, 817.2 - 33);\r\n\r\n        ctx.fillStyle = '#2DB226';\r\n        ctx.font = textFont;\r\n\r\n        for (const i in textLines) {\r\n            ctx.fillText(textLines[i], 540, 1080.2 - 201 + textSize + (textSize + 5) * i);\r\n        }\r\n\r\n        return canvas;\r\n    }\r\n\r\n    async uploadStoryPhotoToWall(blob) {\r\n        const\r\n            uploadWallUrl = (await bridge.send('VKWebAppCallAPIMethod', {\r\n                method: 'photos.getWallUploadServer',\r\n                params: {\r\n                    v: '5.126',\r\n                    access_token: this.state.token\r\n                }\r\n            })).response.upload_url,\r\n            bodyFormData = new FormData()\r\n        ;\r\n\r\n        bodyFormData.append('photo', blob, 'image.png');\r\n\r\n        try {\r\n            fetch(proxyUrl + uploadWallUrl, {\r\n                method: 'POST',\r\n                body: bodyFormData\r\n            })\r\n                .then(res_ => {\r\n                    return res_.json();\r\n                })\r\n                .then(async response => {\r\n                    const {server, photo, hash} = response;\r\n                    const wallPhoto = (await bridge.send('VKWebAppCallAPIMethod', {\r\n                        method: 'photos.saveWallPhoto',\r\n                        params: {\r\n                            server,\r\n                            photo,\r\n                            hash,\r\n                            caption: `🙀 Узнай карму своего аккаунта в приложении - https://vk.com/app${getUrlParams().vk_app_id}`,\r\n                            v: '5.126',\r\n                            access_token: this.state.token\r\n                        }\r\n                    })).response[0];\r\n\r\n                    bridge.send('VKWebAppShowWallPostBox', {\r\n                        message: '',\r\n                        copyright: 'https://vk.com/app' + getUrlParams().vk_app_id,\r\n                        attachments: `photo${wallPhoto.owner_id}_${wallPhoto.id}`\r\n                    });\r\n                });\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n\r\n    async uploadStoryPhotoToAlbum(blob) {\r\n        const\r\n            album_id = (await bridge.send('VKWebAppCallAPIMethod', {\r\n                method: 'photos.createAlbum',\r\n                params: {\r\n                    title: 'Сколько стоит моя страница',\r\n                    v: '5.126',\r\n                    access_token: this.state.token\r\n                }\r\n            })).response.id,\r\n            uploadAlbumUrl = (await bridge.send('VKWebAppCallAPIMethod', {\r\n                method: 'photos.getUploadServer',\r\n                params: {\r\n                    album_id,\r\n                    v: '5.126',\r\n                    access_token: this.state.token\r\n                }\r\n            })).response.upload_url,\r\n            bodyFormData = new FormData()\r\n        ;\r\n\r\n        bodyFormData.append('photo', blob, 'image.png');\r\n\r\n        try {\r\n            fetch(proxyUrl + uploadAlbumUrl, {\r\n                method: 'POST',\r\n                body: bodyFormData\r\n            })\r\n                .then(res_ => {\r\n                    return res_.json();\r\n                })\r\n                .then(async response => {\r\n                    const {server, photos_list, hash} = response;\r\n                    await bridge.send('VKWebAppCallAPIMethod', {\r\n                        method: 'photos.save',\r\n                        params: {\r\n                            album_id,\r\n                            server,\r\n                            photos_list,\r\n                            hash,\r\n                            caption: `🙀 Узнай карму своего аккаунта в приложении - https://vk.com/app${getUrlParams().vk_app_id}`,\r\n                            v: '5.126',\r\n                            access_token: this.state.token\r\n                        }\r\n                    });\r\n                });\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    }\r\n\r\n    get loadingComponent() {\r\n        const\r\n            {messages, currentMessageIndex} = this.state,\r\n            percent = Math.round(100 / messages.length * (currentMessageIndex + 1))\r\n        ;\r\n\r\n        return <div className='Progress'>\r\n            <span>{percent}<span style={{color: '#3AD431'}}>%</span></span>\r\n            <img style={{animationPlayState: percent === 100 && 'paused'}} alt='progress'\r\n                 src={require('../assets/acc_karma/icons/progress.png')}/>\r\n        </div>\r\n    }\r\n\r\n    render() {\r\n        const\r\n            {\r\n                activePanel, activeModal, popout,\r\n                messages, currentMessageIndex, karma, result_text,\r\n\r\n                snackbar,\r\n\r\n                app\r\n            } = this.state,\r\n\r\n            panels = [\r\n                {\r\n                    title: 'Привет!',\r\n                    description: 'Мы оцениваем твою страницу, считывая множество разных показателей. Оценка каждой страницы пропорциональна ее ценности.',\r\n                    button:\r\n                        <Button onClick={() => this.setState({activePanel: 'p1'})}>\r\n                            Ок\r\n                        </Button>\r\n                },\r\n                {\r\n                    title: 'Чтобы узнать карму вашего аккаунта нам потребуется доступ к вашим личным данным',\r\n                    button:\r\n                        <Button\r\n                            onClick={async () => {\r\n                                try {\r\n                                    this.setState({activePanel: 'p2', token: await this.getToken('photos,wall')})\r\n                                } catch (e) {\r\n                                    if (snackbar) return;\r\n                                    this.setState({\r\n                                        snackbar: <Snackbar\r\n                                            onClose={() => this.setState({snackbar: null})}\r\n                                            before={<Icon16ErrorCircleFill width={20} height={20}/>}\r\n                                        >\r\n                                            Без доступа я не смогу проанализировать твою страницу :(\r\n                                        </Snackbar>\r\n                                    });\r\n                                }\r\n                            }}\r\n                        >\r\n                            Разрешить доступ\r\n                        </Button>\r\n                },\r\n                {\r\n                    title: 'Спасибо, доступ получен!',\r\n                    button:\r\n                        <Button\r\n                            onClick={async () => {\r\n                                try {\r\n                                    await bridge.send('VKWebAppAllowMessagesFromGroup', {\r\n                                        group_id: app.group_id_message[0],\r\n                                        key: 'FSDIfulnwje'\r\n                                    });\r\n                                } catch (e) {\r\n                                }\r\n\r\n                                this.setState({activePanel: 'p3', subShow: false, popout: <ScreenSpinner/>});\r\n\r\n                                try {\r\n                                    await bridge.send('VKWebAppShowNativeAds', {ad_format: 'preloader'});\r\n                                } catch (e) {\r\n                                }\r\n\r\n                                this.setState({popout: null});\r\n\r\n                                let interval = setInterval(async () => {\r\n                                    if (!this.state.subShow) {\r\n                                        const i = this.state.currentMessageIndex;\r\n                                        if (i >= messages.length - 1) {\r\n                                            clearInterval(interval);\r\n                                            this.go('p4');\r\n\r\n                                            bridge.send('VKWebAppShowNativeAds', {ad_format: 'preloader'});\r\n                                            return;\r\n                                        } else {\r\n                                            this.setState({currentMessageIndex: i + 1});\r\n                                        }\r\n                                        if (i === 4) {\r\n                                            this.setState({subShow: true, activeModal: 'group'});\r\n                                        }\r\n                                    }\r\n                                }, 1250 * 2);\r\n\r\n                                try {\r\n\r\n                                    const\r\n                                        savedData = JSON.parse((await bridge.send('VKWebAppStorageGet', {keys: ['karm1']})).keys[0].value)\r\n                                    ;\r\n                                    await this.setState(savedData);\r\n                                } catch (e) {\r\n                                    const\r\n                                        counters = (await bridge.send('VKWebAppCallAPIMethod', {\r\n                                            method: 'users.get',\r\n                                            params: {\r\n                                                fields: 'counters',\r\n                                                v: '5.126',\r\n                                                access_token: this.state.token\r\n                                            }\r\n                                        })).response[0].counters,\r\n                                        karma = true ? getRandomInt(0, 1000) : Math.round(1000 * Math.min(1, Object.keys(counters).map(key =>\r\n                                            (counters[key] === 0 ? 1 : counters[key]) / (normalCounters[key] || 1)\r\n                                        ).reduce((a, b) => a + b) / Object.keys(counters).length)),\r\n                                        result_text = karma <= 333 ? 'Ты очень плохо себя ведёшь в соц сети' : (karma <= 666 ? 'Ты ведёшь себя неплохо, но и не очень хорошо в соц сети' : 'Ты очень хорошо себя ведёшь в соц сети')\r\n                                    ;\r\n                                    await this.setState({karma, result_text});\r\n                                    await bridge.send('VKWebAppStorageSet', {\r\n                                        key: 'karm1',\r\n                                        value: JSON.stringify({karma, result_text})\r\n                                    });\r\n                                }\r\n\r\n                                try {\r\n                                    const\r\n                                        canvas = await this.getStoryCanvas(),\r\n                                        blob = await new Promise(resolve => canvas.toBlob(blob => resolve(blob)))\r\n                                    ;\r\n                                    await this.uploadStoryPhotoToAlbum(blob);\r\n                                } catch (e) {\r\n                                }\r\n                            }}\r\n                        >\r\n                            Узнать карму аккаунта\r\n                        </Button>\r\n                },\r\n                {\r\n                    icon: this.loadingComponent,\r\n                    title: 'Идёт оценка...',\r\n                    description: messages[currentMessageIndex]\r\n                },\r\n                {\r\n                    icon: this.loadingComponent,\r\n                    title: 'Анализ завершен!',\r\n                    button:\r\n                        <Button\r\n                            onClick={() => {\r\n                                this.shareStory();\r\n                            }}\r\n                        >\r\n                            Опубликовать анализ в истории\r\n                        </Button>\r\n                },\r\n            ],\r\n\r\n            modal = (\r\n                <ModalRoot\r\n                    activeModal={activeModal}\r\n                    onClose={() => this.setState({activeModal: null})}\r\n                >\r\n                    <ModalCard\r\n                        id='group'\r\n                        onClose={() => {\r\n                            this.setState({subShow: false, activeModal: null});\r\n                        }}\r\n                        icon={<Avatar size={72} shadow={false}\r\n                                      src={require('../assets/vk_acc_price/icons/group_subscribe.png')}/>}\r\n                        header='Пока ты ждешь анализ, подпишись на наш крутой паблик. Тебе понравится!'\r\n                        actions={\r\n                            <Button\r\n                                onClick={async () => {\r\n                                    try {\r\n                                        await bridge.send('VKWebAppJoinGroup', {\r\n                                            group_id: app.group_id_join[0],\r\n                                            key: 'FSDIfulnwje'\r\n                                        });\r\n                                    } catch (e) {\r\n                                        console.error(e);\r\n                                    }\r\n                                    this.setState({subShow: false, activeModal: null});\r\n                                }}>\r\n                                Присоединиться\r\n                            </Button>\r\n                        }\r\n                    />\r\n                </ModalRoot>\r\n            )\r\n        ;\r\n\r\n        return (\r\n            <ConfigProvider isWebView={true}>\r\n                <View\r\n                    activePanel={activePanel}\r\n                    popout={popout}\r\n                    onSwipeBack={this.back}\r\n                    modal={modal}\r\n                >\r\n                    {\r\n                        panels.map((value, index) =>\r\n                            <Panel id={`p${index}`} key={`p${index}`}>\r\n                                <div className='FullScreen__Container'>\r\n                                    {\r\n                                        value.icon\r\n                                        ||\r\n                                        <img alt='icon' src={require('../assets/acc_karma/icons/' + index + '.png')}/>\r\n                                    }\r\n                                    <div className='FullScreen__Title'>\r\n                                        {value.title}\r\n                                    </div>\r\n                                    {\r\n                                        value.description && <div className='FullScreen__Description'>\r\n                                            {value.description}\r\n                                        </div>\r\n                                    }\r\n                                    {\r\n                                        value.button\r\n                                    }\r\n                                </div>\r\n                                <img alt='bg' className='Background'\r\n                                     src={require('../assets/acc_karma/app_bg/green.png')}/>\r\n                                {snackbar}\r\n                            </Panel>\r\n                        )\r\n                    }\r\n                    <Panel id='p7'>\r\n                        <div className='FullScreen__Container'>\r\n                            <div className='ButtonsContainer'>\r\n                                {\r\n                                    [\r\n                                        {\r\n                                            icon: <IconResult/>,\r\n                                            text: 'Посмотреть результат',\r\n                                            onClick: () => {\r\n                                                this.go('p5');\r\n                                            }\r\n                                        },\r\n                                        ...needSubApp ? [{\r\n                                            icon: <IconPosterApp/>,\r\n                                            text: 'Узнать сколько стоит твоя страница ВК',\r\n                                            onClick: () => {\r\n                                                openUrl('https://vk.com/app' + subAppID);\r\n                                            }\r\n                                        }] : []\r\n                                    ].map((value, index) =>\r\n                                        <Button\r\n                                            key={'btn-' + index}\r\n                                            before={value.icon}\r\n                                            onClick={() => value.onClick()}\r\n                                            style={{\r\n                                                marginTop: index > 0 && 16\r\n                                            }}\r\n                                        >\r\n                                            {value.text}\r\n                                        </Button>\r\n                                    )\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                        <img alt='bg' className='Background' src={require('../assets/acc_karma/app_bg/green.png')}/>\r\n                    </Panel>\r\n                    <Panel id='p5'>\r\n                        <div className='FullScreen__Container'>\r\n                            <div className='TextHeader'>\r\n                                Карма твоего аккаунта:\r\n                            </div>\r\n                            <div className='Karma'>\r\n                                {karma}/1000\r\n                            </div>\r\n                            <div className='ResultText'>\r\n                                {result_text}\r\n                            </div>\r\n                            <Button\r\n                                className='FullScreen__Button'\r\n                                onClick={() => this.shareStory()}\r\n                            >\r\n                                Поделиться в истории\r\n                            </Button>\r\n                            <img alt='bg' className='Background'\r\n                                 src={require(`../assets/acc_karma/app_bg/${karma <= 333 ? 'red' : (karma <= 667 ? 'yellow' : 'green')}.png`)}/>\r\n                        </div>\r\n                    </Panel>\r\n                    <Panel id='sub_app'>\r\n                        <div className='PosterHeader'>\r\n                            Хочешь узнать сколько стоит твоя страница в ВК?\r\n                        </div>\r\n                        <div className='PosterSubheader'>\r\n                            Тогда переходи в наше <br/><span style={{color: '#3AD431'}}>новое приложение</span>\r\n                        </div>\r\n                        <img alt='poster' className='PosterImage'\r\n                             src={require('../assets/acc_karma/vk_acc_price.png')}/>\r\n                        <div className='ButtonsContainer'>\r\n                            <Button\r\n                                before={<IconPosterApp/>}\r\n                                onClick={() => openUrl('https://vk.com/app' + subAppID)}\r\n                            >\r\n                                Перейти в приложение\r\n                            </Button>\r\n                            <Button\r\n                                style={{marginTop: '2.77vh'}}\r\n                                before={<IconResult/>}\r\n                                onClick={() =>\r\n                                    this.setState({activePanel: 'p7', history: ['p7']})\r\n                                }\r\n                            >\r\n                                Вернуться к результату\r\n                            </Button>\r\n                        </div>\r\n                        <img alt='bg' className='Background' src={require('../assets/acc_karma/app_bg/green.png')}/>\r\n                    </Panel>\r\n                </View>\r\n            </ConfigProvider>\r\n        );\r\n    }\r\n}\r\n\r\nexport default AccKarma;","import 'core-js/features/map';\nimport 'core-js/features/set';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport '@vkontakte/vkui/dist/unstable.css'\nimport {AdaptivityProvider, AppRoot, ConfigProvider} from \"@vkontakte/vkui\";\n\nimport './css/Fonts.css';\nimport './css/Error.css';\nimport './css/Utils.css';\n\n//import App from './apps/Tracker';\n//import App from './apps/Wheel';\n//import App from './apps/MedicalCard';\n//import App from './apps/AskMe';\n//import App from './apps/LoveAnalysis';\n//import App from './apps/BattleStat';\n//import App from './apps/BattleStatCatalog';\n//import App from './apps/YearTest';\n//import App from './apps/IQTest';\n//import App from './apps/MvsW';\n//import App from './apps/DeathDate';\n//import App from './apps/DeathDate2';\n//import App from './apps/Slaves';\n//import App from './apps/VKTime';\n//import App from './apps/LikesStat';\n//import App from './apps/VKAccPrice';\n//import App from './apps/DateCelebrity';\n//import App from './apps/NameInCountry';\nimport App from './apps/AccKarma';\n//import App from './apps/AdvertisementApp';\n//import App from './apps/AdvertisementAppSite';\n//import App from './apps/ClickerBattle/ClickerBattle';\n//import App from './apps/Drawing/Drawing';\n//import App from './apps/Drawing/Global';\n//import App from './apps/RandomCooking';\n\n\nReactDOM.render(\n    false ?\n        <App/>\n        :\n        <ConfigProvider>\n            <AdaptivityProvider>\n                <AppRoot>\n                    <App/>\n                </AppRoot>\n            </AdaptivityProvider>\n        </ConfigProvider>, document.getElementById('root')\n);\n","module.exports = __webpack_public_path__ + \"static/media/green.5dd55922.png\";","module.exports = __webpack_public_path__ + \"static/media/progress.31236f30.png\";"],"sourceRoot":""}